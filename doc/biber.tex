\documentclass{ltxdockit}
\usepackage[british]{babel}
\usepackage[strict=true,autostyle=true]{csquotes}
\usepackage{ifthen}
\usepackage{fontspec}
\setmainfont[Ligatures=TeX]{TeXGyrePagella}
\setsansfont{Arial}
\setmonofont{Courier New}

\MakeAutoQuote{«}{»}

\titlepage{%
  title={biber},
  subtitle={A backend bibliography processor for biblatex},
  url={http://biblatex-biber.sourceforge.net},
  author={François Charette, Philip Kime},
  email={firmicus@ankabut.net, Philip@kime.org.uk},
  revision={1},
  date={\today}}

\hypersetup{%
  pdftitle={biber},
  pdfsubject={A backend bibliography processor for biblatex},
  pdfauthor={Philip Kime},
  pdfkeywords={biblatex, bibliography}}



\def\biberex#1{\hbox{\hspace{-4em}\texttt{\small \detokenize{#1}}}}

\begin{document}

\printtitlepage
\tableofcontents

\section{Introduction}
\label{int}

\subsection{About}

\verb+biber+ is conceptually a \verb+bibtex+ replacement for
\verb+biblatex+. It is written in Perl with the aim of providing a
customised and sophisticated data preparation backend for \verb+biblatex+
Functionally, it offers a superset of \verb+bibtex+'s capabilities but is
tightly coupled with \verb+biblatex+ and cannot be used as a stand-alone tool
with standard \verb+.bst+ styles.

\subsection{Requirements}\label{ref:req}

\verb+biber+ is distributed in two ways. There is a perl source
version which requires you to have a working perl installation
(preferably version 5.12 but no less than 5.10) and the ability to
install the pre-requisite modules. Also provided are binaries for
major OSes built with the perl \verb+PAR::Packer+ module and utilities.

Currently there are binaries available for:

\begin{itemize}
\item OSX Intel 64-bit
\item Windows
\item Linux 32-bit
\item Linux 64-bit
\end{itemize}

These should work on any fairly recent OS version. Both binaries and
perl source are available on SourceForge\footnote{\url{http://sourceforge.net/projects/biblatex-biber/}}.

\subsection{License}

\verb+biber+ is released under the free sortware Artistic License 2.0\footnote{\url{http://www.opensource.org/licenses/artistic-license-2.0.php}}

\subsection{History}

\verb+bibtex+ has been the default (only \ldots) integrated choice for
bibliography processing in TeX for a long time. It has well known
limitations which stem from its data format, data model and lack of UTF-8
support\footnote{In fact, there is now a UTF-8 compliant version}. The
\verb+.bst+ language for writing bibliography styles is painful to learn
and use. It is not a general programming language and this make it really
very hard to do sophisticated automated processing of bibliographies.

\verb+biblatex+ was a major advance for LaTeX users as it moved much
of the bibliography processing into LaTeX macros. However,
\verb+biblatex+ still used \verb+bibtex+ as a sorting engine for the
bibliography and also to generate various labels for
entries. \verb+bibtex+'s capabilities even for this reduced set of
tasks was still quite restricted due to the lack of UTF-8 support and
the more and more complex programming issues involved in label
preparation and file encoding.

\verb+biber+ was designed specifically for \verb+biblatex+ in order to
provide a powerful backend engine which could deal with any required
tasks to do with \verb+.bbl+ preparation. It can

\begin{itemize}
\item Deal with the full range of UTF-8
\item Sort in a completely customisable manner, using when available,
  CLDR collation tailorings
\item Automatically encode the \verb+.bbl+ into any supported encoding
  format
\item Process all bibliography sections in one pass of the tool
\item Handle UTF-8 citekeys and filenames (given a suitable fully
  UTF-8 compliant TeX engine)
\item Handle very complex auto-expansion and contraction of names and
  namelists.
\item Lots of other things
\end{itemize}

\subsection{Acknowledgments}

François Charette originally wrote \verb+biber+. Philip Kime joined in
the development in 2009.

\section{Use}

Firstly, running \verb+biber --help+ will display all options and a brief
description of each. This is the most useful brief source of usage
information.

With the \verb+backend=biber+ option \verb+biblatex+ switches its backend
interface and passes all options and information relevant to \verb+biber+'s
operation in a file with extension \verb+.bcf+\footnote{BibLaTeX Control
  File}. This is conceptually equivalent to the \verb+.aux+ file which
LaTeX uses to pass information to \verb+bibtex+. The \verb+.bcf+ file is
XML and contains many options and settings which configure how \verb+biber+
is to process the bibliography and generate the \verb+.bbl+ file.

\verb+biber+ sets its options using the following resource 
chain which is given in decreasing precedence order:\\[2ex]

\noindent command line options $\rightarrow$\\
\hspace*{1em}\verb+biber.conf+ file $\rightarrow$\\
\hspace*{2em}\verb+.bcf+ file$\rightarrow$\\
\hspace*{3em}\verb+biber+ hard-coded defaults\\[2ex]

Users do not need to care directly about the contents or format of the
\verb+.bcf+ file as this is generated from the options which they specify
for \verb+biblatex+. To override the \verb+.bcf+ options or to provide
option settings when no \verb+.bcf+ file is used (see for example the
\verb+--allentries|-a+ and \verb+--bibdata|-d+ options), users
may use either a configuration file or the command line to set options.

The configuration file is by default called \verb+biber.conf+ but this can
be changed using the \verb+--configfile|-g+ option. Unless
\verb+--configfile|-g+ is used, the config file is
looked for in the following places, in decreasing order of preference:\\[2ex]

\noindent \verb+biber.conf+ in the current directory $\rightarrow$\\
\hspace*{1em}\verb+$HOME/.biber.conf+ $\rightarrow$\\
\hspace*{2em}\verb+$ENV{XDG_CONFIG_HOME}/biber/biber.conf+ $\rightarrow$\\
\hspace*{3em}\verb+$HOME/Library/biber/biber.conf+ (Mac OSX only)
$\rightarrow$\\
\hspace*{3em}\verb+$ENV{APPDATA}/biber.conf+ (Windows only) $\rightarrow$\\
\hspace*{4em}the output of \verb+kpsewhich biber.conf+ (if available on the
system)\\[2ex]

The config file format is a very flexible one which allows users to specify
options in most common formats, even mixed in the same file. It's easier to
see an example. Here is a config file which displays the \verb+biber+
hard-coded defaults for both global \verb+biber+ and global \verb+biblatex+
options.

\begin{verbatim}
allentries          0
bblencoding         UTF-8
bibdata             undef 
bibending           UTF-8
collate             1
<collate_options>
    level           2
</collate_options>
debug               0
fastsort            0
mincrossrefs        2
nolog               0
nosortdiacritics    [\x{2bf}\x{2018}]
nosortprefix        \p{L}{2}\p{Pd}
quiet               0
sortcase            1
sortlocale          en_US.utf8
sortupper           1
trace               0
validate            0
wraplines           0
\end{verbatim}

You can see here that options with multiple key/value pairs of their own
like \verb+--collate_options|-c+ can be specified in
Apache config format. Please see the documentation
for the \verb+Config::General+ Perl
module\footnote{\url{http://search.cpan.org/search?query=Config::General&mode=all}}
if you really need details. In practise, if you use a config file at all
for \verb+biber+, it will contain very little as you will usually set all
options by setting options in \verb+biblatex+ which will pass them to
\verb+biber+ via the \verb+.bcf+ file.

The \verb+--collate_options|-c+ option takes a number of key/value pairs as
value. See section \ref{coll} for details. The value of the \verb+nosort*+
options can only be set in the config file and not on the command line.
This is because the values are Perl regular expressions and would need special
quoting to set on the command line. This can get a bit tricky on some OSes
(like Windows) so it's safer to set then in the config file. They specify
stand-alone diacritic marks and name prefices to strip before sorting takes
place and are designed to deal with cases like

\begin{verbatim}
  author	   = {{al-Hasan}, ʿAlī},
\end{verbatim}

\noindent where the prefix «al-» and the diacritic «ʿ» should not be
considered when sorting.

\subsection{Collation and Localisation}\label{coll}

\verb+biber+ takes care of collating (sorting) the bibliography for
\verb+biblatex+. It writes entries to the \verb+.bbl+ file sorted by a
completely customisable set of rules which are passed in the
\verb+.bcf+ file by \verb+biblatex+. \verb+biber+ has two ways of performing
collation:\\[2ex]

\biberex{--collate|-C} The default. This option makes \verb+biber+ use the
  \verb+Unicode::Collate+ module for collation which implements the full UCA (Unicode
  Collation Algorithm). It also has CLDR (Common Locale Data
  Repository) tailoring to deal with cases which are not covered by the
  UCA. It is a little slower than \verb+--fastsort|-f+ but the
  advantages are such that it's rarely worth using \verb+--fastsort|-f+\\[1ex]

\biberex{--fastsort|-f} Biber will sort using
  the OS locale collation tables. The drawback for this method is that special
  collation tailoring for various languages are not implemented in the
  collation tables for many OSes. For example, few OSes correctly sort 'å'
  before 'ä' in the Swedish (\verb+sv_SE+) locale. If you are using a
  common latin alphabet, then this is probably not a problem for you.\\[2ex]

\noindent The locale used for collation is determined by the following resource
chain which is given in decreasing precedence order:\\[2ex]

\noindent\verb+--collate_options|-c+ (e.g. \verb+-c 'locale => "de_DE"'+) $\rightarrow$\\
\hspace*{1em}\verb+--sortlocale|-l+ $\rightarrow$\\
\hspace*{2em}\verb+LC_COLLATE+ environment variable $\rightarrow$\\
\hspace*{3em}\verb+LANG+ environment variable $\rightarrow$\\
\hspace*{4em}\verb+LC_ALL+ environment variable\\[2ex]

\noindent With the default \verb+--collate|-C+ option, the locale will
be used to look for a collation tailoring for that locale. It will generate an
information warning if it finds none. This is not a problem as the vast
majority of collation cases are covered by the basic standard UCA and many
locales neither have nor need any special collation tailoring.

With the \verb+--fastsort|-f+ option, the locale will be
used to locate an OS locale definition to use for the collation. This
may or may not be correctly tailored, depending on the locale and the OS.\\[1ex]

\noindent Collation is by default case sensitive. You can turn this
off using the \verb+biber+ option \verb+--sortcase=0+ or from
\verb+biblatex+ using its option \verb+sortcase=false+.\\[1ex]

\noindent\verb+--collate|-C+ by default collates uppercase before
lower. You can reverse this using the \verb+biber+ option \verb+--sortupper=0+
or from \verb+biblatex+ by using its option \verb+sortupper=false+.\\[1ex]

There are in fact many options to \verb+Unicode::Collate+
which can tailor the collation in various ways in
addition to the locale tailoring which is automatically performed.
Users should see the the documentation to the module for the various
options, most of which the vast majority of users will never
need\footnote{For details on the various options, see
  \url{http://search.cpan.org/search?query=Unicode\%3A\%3ACollate&mode=all}}.
Options are passed as a single quoted string, each option separated by
comma, each option and value separated by «\verb+=>+». See examples.

\subsubsection{Examples}

\biberex{biber}

\noindent Call biber using all settings from the \verb+.bcf+ generated from the
LaTeX run. Case sensitive UCA sorting is performed taking the locale
for tailoring from the environment if no \verb+sortlocale+ is defined in
the \verb+.bcf+

\biberex{biber --sortlocale=de_DE}

\noindent Override any locale setting in the \verb+.bcf+ or
the environment.

\biberex{biber --fastsort}

\noindent Use slightly quicker internal sorting routine. This uses the OS locale
files which may or may not be accurate.

\biberex{biber --sortcase=0}

\noindent Case insensitive sorting.

\biberex{biber --sortupper=0 --collate_options="backwards => 2"}

\noindent Collate lowercase before upper and collate French accents in
reverse order at UCA level 2.

\subsection{Encoding of files}

\verb+biber+ takes care of reencoding the \verb+.bib+ data as
necessary. In normal use, \verb+biblatex+ passes its
\verb+bibencoding+ option value to \verb+biber+ via the \verb+.bcf+
file. It also passes an option \verb+bblencoding+ the value of which
is derived from the \verb+inputenc+ package setting (if the user is
using this), otherwise «utf8» (for XeTeX or LuaTeX) or «ascii» (any
other TeX engine).

\noindent \verb+biber+ performs the following tasks:

\begin{enumerate}
\item Decodes the \verb+.bib+ into UTF-8 if it is not UTF-8 already
\item Decodes LaTeX character macros into UTF-8 unless \verb+--latexdecode=0+
\item Encodes the output so that the \verb+.bbl+ is in
  the encoding that \verb+bblencoding+ specifies.
\item Warns if it is asked to output to the \verb+.bbl+ any UTF-8
  decoded LaTeX character macros which are not in the
  \verb+bblencoding+ encoding. Replaces with a diacritic-stripped substitute.
\end{enumerate}

\noindent As you can see from item 2 above, by default, \verb+biber+
converts LaTeX character macros into UTF-8 internally. This is very
useful as it means that things are sorted correctly but has two
potential (but rare) problems which you should be aware of:

\begin{itemize}
\item If you are using PDFLaTeX and \verb+\usepackage[utf8]{inputenc}+, it
  is possible that the UTF-8 characters resulting from \verb+biber+'s
  internal LaTeX character macro decoding break \verb+inputenc+. This
  is because \verb+inputenc+ does not implement all of UTF-8, only a
  commonly used subset. 

  An example--if you had \verb+\DJ+ in your \verb+.bib+,
  \verb+biber+ decodes this correctly to «Đ» and this breaks \verb+inputenc+
  because it doesn't understand that UTF-8 character. The solution
  here is to switch to a TeX engine with full UTF-8 support like XeTeX or
  LuaTeX as these don't use or need \verb+inputenc+.
\item If your \verb+bblencoding+ is not UTF-8, and you are using some
  UTF-8 equivalent LaTeX character macros in your \verb+.bib+, then
  some \verb+.bbl+ fields (currently only \verb+\sortinit{}+) might
  end up with invalid character in them, according to the \verb+.bbl+
  encoding. This is because some fields must be generated from the
  final sorting data which is only available after the LaTeX character
  macro decoding step.

  For example, suppose you were using PDFLaTeX with\\
  \verb+\usepackage[latin1]{inputenc}+ and the following
  \verb+.bib entry+

  \begin{verbatim}
    @BOOK{citekey1,
      AUTHOR = {{\v S}imple, Simon},
    }
  \end{verbatim}

  \noindent With normal LaTeX character macro decoding, the
  \verb+{\v S}+ is decoded into «Š» and so with name-first sorting,
  \verb+\sortinit{}+ would be «Š». This is an invalid character in
  latin1 encoding and so the \verb+.bbl+ would be broken. In such
  cases when \verb+\sortinit{}+ is a char not valid in the
  \verb+bblencoding+, \verb+biber+ strips off any diacritics which in
  this case results in «S». This is not ideal as this is not the
  initial character of the string used for sorting any more but it's a
  decent replacement in such cases. The solution is really
  to use UTF-8 \verb+bblencoding+ wherever possible. In extreme cases like
  the one above, this might also mean switching TeX engines to one that
  supports full UTF-8.
\end{itemize}

\noindent Normally, you do not need to set the encoding options on the
\verb+biber+ command line as they are passed in the \verb+.bcf+ via
the information in your \verb+biblatex+ environment. However, you can
override the \verb+.bcf+ settings with the command line.

\subsubsection{Examples}

\biberex{biber}

\noindent Read \verb+bibencoding+ and \verb+bblencoding+ from the
\verb+.bcf+.

\biberex{biber --bblencoding=latin2}

\noindent Encode the \verb+.bbl+ as latin2, overriding the
\verb+.bcf+.

\biberex{biber -u}

\noindent Shortcut alias for \verb+biber --bibencoding=UTF-8+

\biberex{biber -U}

\noindent Shortcut alias for \verb+biber --bblencoding=UTF-8+

\subsection{Limitations}

Currently, users are restricted to the bibliography entry types hard-coded
into \verb+biblatex+. This is mitigated a little by the custom fields
listed in section 2.2.4 of the \verb+bibatex+ manual but these are not
portable or semantically obvious in their meaning. It is planned to have a
customisable interface in \verb+biblatex+ which will allow users to define
entry types an fields and have these passed through to \verb+biber+ which
will validate the structure of the bibliography against these definitions.
This would allow a fully customisable data model interface. Currently this
is impossible due to a reliance on the \verb+.bib+ format which is quite
restricted in scope and extensibility. It is likely that \verb+biblatex+
and \verb+biber+ will move to a modular data layer with an XML format as
the default. \verb+.bib+ support will be maintained as a legacy format.

Currently it is not possible to automatically expand name lists to their
minimally unique truncation which is required by some styles (APA for
example). This is quite a hard problem which is implemented in an
experimental \verb+biber+ branch but need \verb+biblatex+ support,
envisaged for version 2.x. It requires an enhanced \verb+.bbl+ format,
among other things.
\end{document}
